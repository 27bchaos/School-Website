<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>US Gov Cup Drop Quiz Enhanced</title>
<style>
body { font-family: sans-serif; background:#e3eefc; text-align:center; margin:0; overflow-x:hidden;}
h1{color:#1a3c6d; margin-top:20px;}
button{margin:5px;padding:10px 18px;border:none;border-radius:6px;background:#1a3c6d;color:white;cursor:pointer;font-size:16px;}
button:hover{background:#345b8c;}
#playerSelect, #gameContainer{margin-top:20px;}
#questionBox{background:#fff;padding:20px;margin:0 auto;width:60%;border-radius:10px;box-shadow:0 0 10px #aaa;}
#answers button{display:block;width:200px;margin:5px auto;}
#scoreBoard{margin-top:20px;font-size:18px;color:#1a3c6d;}
#cupContainer{position:relative; width:600px; height:400px; margin:30px auto; background:#d0f0f0; border:2px solid #1a3c6d; border-radius:10px; overflow:hidden;}
.cup{position:absolute; bottom:0; width:80px; height:60px; border-radius:10px; text-align:center; color:white; font-weight:bold; line-height:60px;}
.ball{position:absolute; width:10px; height:10px; border-radius:50%; background:black;}
.peg{position:absolute; width:10px; height:10px; border-radius:50%; background:#1a3c6d;}
</style>
</head>
<body>

<h1>üéØ US Gov Cup Drop Quiz Enhanced</h1>

<div id="playerSelect">
  <h3>Select Mode:</h3>
  <button onclick="startSingle()">Single Player</button>
  <button onclick="startMulti()">Multiplayer</button>
</div>

<div id="gameContainer" style="display:none;">
  <div id="questionBox">
    <h2 id="question"></h2>
    <div id="answers"></div>
    <p id="timer"></p>
  </div>

  <div id="scoreBoard"></div>

  <div id="cupContainer"></div>

  <h2 id="result"></h2>
  <button id="replayBtn" style="display:none;" onclick="restartGame()">Play Again</button>
</div>

<script>
// === QUESTIONS ===
const questions = [
  {q:"Which branch of government makes the laws?", a:["Legislative","Executive","Judicial"], c:0},
  {q:"Which branch enforces the laws?", a:["Legislative","Executive","Judicial"], c:1},
  {q:"Which branch interprets the laws?", a:["Judicial","Executive","Legislative"], c:0},
  {q:"Congress is part of which branch?", a:["Judicial","Legislative","Executive"], c:1},
  {q:"The President leads which branch?", a:["Legislative","Executive","Judicial"], c:1},
  {q:"The Supreme Court is part of which branch?", a:["Executive","Judicial","Legislative"], c:1},
];

let players = [];
let currentPlayer = 0;
let index = 0;
let earnedCups = 0;
let questionTimer;
const maxTime = 15; // seconds

const qBox = document.getElementById('question');
const ansBox = document.getElementById('answers');
const result = document.getElementById('result');
const gameContainer = document.getElementById('gameContainer');
const playerSelect = document.getElementById('playerSelect');
const scoreBoard = document.getElementById('scoreBoard');
const cupContainer = document.getElementById('cupContainer');
const timerDisplay = document.getElementById('timer');
const replayBtn = document.getElementById('replayBtn');

// === START GAME ===
function startSingle() { players = [{name:"Player 1", score:0}]; startGame(); }
function startMulti() {
  const p1 = prompt("Enter Player 1 Name:", "Player 1");
  const p2 = prompt("Enter Player 2 Name:", "Player 2");
  players = [{name:p1||"Player 1", score:0},{name:p2||"Player 2", score:0}];
  startGame();
}

function startGame(){
  playerSelect.style.display="none";
  gameContainer.style.display="block";
  index=0; currentPlayer=0;
  earnedCups=0;
  renderScore();
  replayBtn.style.display="none";
  loadQuestion();
}

function restartGame(){
  players.forEach(p=>p.score=0);
  index=0;
  currentPlayer=0;
  earnedCups=0;
  result.textContent="";
  cupContainer.innerHTML="";
  replayBtn.style.display="none";
  renderScore();
  loadQuestion();
}

function renderScore(){
  scoreBoard.innerHTML = players.map(p=>`${p.name}: ${p.score}`).join(" | ");
}

// === LOAD QUESTIONS ===
function loadQuestion(){
  if(index >= questions.length){
    startCupDrop();
    return;
  }
  const q = questions[index];
  qBox.textContent = `${players[currentPlayer].name}'s turn: ${q.q}`;
  ansBox.innerHTML = "";
  timerDisplay.textContent = `Time Left: ${maxTime}s`;
  let timeLeft = maxTime;

  questionTimer = setInterval(()=>{
    timeLeft--;
    timerDisplay.textContent = `Time Left: ${timeLeft}s`;
    if(timeLeft<=0){
      clearInterval(questionTimer);
      alert("‚è∞ Time's up! No cup earned.");
      nextQuestion();
    }
  },1000);

  q.a.forEach((opt,i)=>{
    let btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = ()=>{
      clearInterval(questionTimer);
      if(i === q.c){
        alert("‚úÖ Correct! You earned a cup!");
        earnedCups++;
      } else {
        alert("‚ùå Incorrect! No cup earned.");
      }
      nextQuestion();
    };
    ansBox.appendChild(btn);
  });
}

function nextQuestion(){
  index++;
  currentPlayer = (currentPlayer+1)%players.length;
  loadQuestion();
}

// === CUP DROP ===
function startCupDrop(){
  qBox.textContent = "üéâ Balls are dropping!";
  ansBox.innerHTML = "";
  timerDisplay.textContent = "";

  cupContainer.innerHTML = "";

  // Cup colors with points and multipliers
  const cupColors = [
    {color:"red", points:10},
    {color:"green", points:25},
    {color:"gold", points:50},
    {color:"blue", points:100},
    {color:"purple", points:200}
  ];

  const cupCount = earnedCups;
  const cupSpacing = 600 / (cupCount+1);

  let cups = [];
  for(let i=0;i<cupCount;i++){
    const cup = document.createElement("div");
    cup.className="cup";
    cup.style.left = (cupSpacing*(i+1)-40)+"px";
    const c = cupColors[i % cupColors.length];
    cup.style.background = c.color;
    cup.dataset.points = c.points;
    cup.textContent = `${c.points}`;
    cupContainer.appendChild(cup);
    cups.push(cup);
  }

  // Add pegs for bouncing
  const pegs = [];
  for(let row=1; row<7; row++){
    for(let col=0; col<7; col++){
      const peg = document.createElement("div");
      peg.className="peg";
      let x = col*90 + (row%2)*45 + 30;
      let y = 400 - row*50;
      peg.style.left = x+"px";
      peg.style.bottom = y+"px";
      cupContainer.appendChild(peg);
      pegs.push(peg);
    }
  }

  // Drop 100 balls
  const balls = [];
  for(let i=0;i<100;i++){
    const ball = document.createElement("div");
    ball.className="ball";
    ball.style.left = (Math.random()*580)+"px";
    ball.style.bottom = "380px";
    cupContainer.appendChild(ball);
    balls.push(ball);
  }

  // Animate balls with basic bouncing physics
  let landed = 0;
  balls.forEach(ball=>{
    let vx = (Math.random()-0.5)*2; // horizontal velocity
    let vy = -2; // initial downward
    let interval = setInterval(()=>{
      let bottom = parseFloat(ball.style.bottom);
      let left = parseFloat(ball.style.left);

      // simple collision with pegs
      pegs.forEach(peg=>{
        const px = parseFloat(peg.style.left);
        const py = parseFloat(peg.style.bottom);
        if(Math.abs(px-left)<10 && Math.abs(py-bottom)<10){
          vx += (Math.random()-0.5)*1;
          vy = 2; // bounce up
        }
      });

      vy -= 0.1; // gravity
      left += vx;
      bottom += vy;

      // bounce off walls
      if(left<0){ left=0; vx*=-1; }
      if(left>590){ left=590; vx*=-1; }

      // land in cups
      if(bottom <= 0){
        bottom=0;
        clearInterval(interval);
        cups.forEach(cup=>{
          const cupLeft = parseFloat(cup.style.left);
          if(left > cupLeft && left < cupLeft + 80){
            players[currentPlayer].score += parseInt(cup.dataset.points);
            renderScore();
            // firework effect
            for(let f=0; f<10; f++){
              const fw = document.createElement("div");
              fw.className="ball";
              fw.style.width="6px";
              fw.style.height="6px";
              fw.style.background="yellow";
              fw.style.left = left+"px";
              fw.style.bottom = bottom+"px";
              cupContainer.appendChild(fw);
              let angle = Math.random()*2*Math.PI;
              let speed = Math.random()*2+1;
              let fwInterval = setInterval(()=>{
                let fwLeft = parseFloat(fw.style.left);
                let fwBottom = parseFloat(fw.style.bottom);
                fwLeft += Math.cos(angle)*speed;
                fwBottom += Math.sin(angle)*speed;
                speed *= 0.9;
                fw.style.left = fwLeft+"px";
                fw.style.bottom = fwBottom+"px";
                if(speed<0.1){ clearInterval(fwInterval); fw.remove(); }
              },30);
            }
          }
        });
        ball.remove();
        landed++;
        if(landed===balls.length){
          endGame();
        }
      }

      ball.style.left = left+"px";
      ball.style.bottom = bottom+"px";
    },20);
  });
}

// === END GAME ===
function endGame(){
  let winner = players.reduce((a,b)=>a.score>b.score?a:b);
  result.textContent = `üèÅ Game Over! Winner: ${winner.name} üéâ`;
  replayBtn.style.display="inline-block";
}
</script>
