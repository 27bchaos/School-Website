<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>US Gov Dart Challenge - Ultimate GamePigeon</title>
<style>
body { font-family: sans-serif; background:#e3eefc; text-align:center; margin:0; overflow-x:hidden;}
h1{color:#1a3c6d; margin-top:20px;}
button{margin:5px;padding:10px 18px;border:none;border-radius:6px;background:#1a3c6d;color:white;cursor:pointer;font-size:16px;}
button:hover{background:#345b8c;}
#playerSelect, #gameContainer{margin-top:20px;}
#questionBox{background:#fff;padding:20px;margin:0 auto;width:60%;border-radius:10px;box-shadow:0 0 10px #aaa;}
#answers button{display:block;width:200px;margin:5px auto;}
#dartContainer{position:relative; margin:30px auto; width:400px; height:400px; border-radius:50%; overflow:hidden; background:#eee; border:5px solid #1a3c6d;}
.dart{width:12px;height:12px;background:black;position:absolute;border-radius:50%; z-index:2;}
#powerBar{height:20px;width:200px;background:lightgray;border-radius:5px;margin:10px auto;overflow:hidden;}
.power{height:100%;width:0%;background:limegreen;}
#scoreBoard{margin-top:20px;font-size:18px;color:#1a3c6d;}
.trajectory{position:absolute;width:6px;height:6px;background:rgba(0,0,0,0.3);border-radius:50%;z-index:1;}
.firework{position:absolute;width:4px;height:4px;background:yellow;border-radius:50%;z-index:3;}
.ring{position:absolute;border-radius:50%;pointer-events:none;}
</style>
</head>
<body>

<h1>ðŸŽ¯ US Gov Dart Challenge</h1>

<div id="playerSelect">
  <h3>Select Mode:</h3>
  <button onclick="startSingle()">Single Player</button>
  <button onclick="startMulti()">Multiplayer</button>
</div>

<div id="gameContainer" style="display:none;">
  <div id="questionBox">
    <h2 id="question"></h2>
    <div id="answers"></div>
  </div>

  <div id="scoreBoard"></div>

  <div id="dartContainer"></div>

  <div id="controls">
    <h3>Drag to set power & angle, release to throw!</h3>
    <div id="powerBar"><div class="power" id="powerFill"></div></div>
    <p id="windInfo"></p>
  </div>

  <h2 id="result"></h2>
</div>

<script>
const questions = [
  {q:"Which branch of government makes the laws?", a:["Legislative","Executive","Judicial"], c:0},
  {q:"Which branch enforces the laws?", a:["Legislative","Executive","Judicial"], c:1},
  {q:"Which branch interprets the laws?", a:["Judicial","Executive","Legislative"], c:0},
  {q:"Congress is part of which branch?", a:["Judicial","Legislative","Executive"], c:1},
  {q:"The President leads which branch?", a:["Legislative","Executive","Judicial"], c:1},
  {q:"The Supreme Court is part of which branch?", a:["Executive","Judicial","Legislative"], c:1},
];

let players = [];
let currentPlayer = 0;
let index = 0;
let dartContainer = document.getElementById('dartContainer');
let powerFill = document.getElementById('powerFill');
let isDragging = false;
let startX = 0, startY = 0;
let angle = 0, power = 0;
let currentDart = null;
let wind = 0;
let throwsLeft = 3;
let countdownInterval = null;
let countdown = 0;
let canThrow = false;

const qBox = document.getElementById('question');
const ansBox = document.getElementById('answers');
const result = document.getElementById('result');
const gameContainer = document.getElementById('gameContainer');
const playerSelect = document.getElementById('playerSelect');
const scoreBoard = document.getElementById('scoreBoard');
const windInfo = document.getElementById('windInfo');

function startSingle() { players = [{name:"Player 1", score:0}]; startGame(); }
function startMulti() {
  const p1 = prompt("Enter Player 1 Name:", "Player 1");
  const p2 = prompt("Enter Player 2 Name:", "Player 2");
  players = [{name:p1||"Player 1", score:0},{name:p2||"Player 2", score:0}];
  startGame();
}

function startGame(){
  playerSelect.style.display="none";
  gameContainer.style.display="block";
  index=0; currentPlayer=0;
  renderScore();
  drawDartboard();
  loadQuestion();
}

function renderScore(){
  scoreBoard.innerHTML = players.map(p=>`${p.name}: ${p.score}`).join(" | ");
}

function loadQuestion(){
  if(index >= questions.length){ endGame(); return; }
  const q = questions[index];
  qBox.textContent = `${players[currentPlayer].name}'s turn: ${q.q}`;
  ansBox.innerHTML = "";
  q.a.forEach((opt,i)=>{
    let btn = document.createElement("button");
    btn.textContent = opt;
    btn.onclick = ()=>checkAnswer(i);
    ansBox.appendChild(btn);
  });
  wind = (Math.random()-0.5)*20;
  windInfo.textContent = `ðŸ’¨ Wind: ${wind.toFixed(1)} units`;
  throwsLeft = 3;
  canThrow = false;
  dartContainer.innerHTML = ""; // clear board until answer is given
  drawDartboard();
}

function checkAnswer(i){
  if(i !== questions[index].c){
    alert("Incorrect! You lose your turn.");
    // Move to next player/question
    nextTurn();
  } else {
    alert("Correct! You get to throw darts!");
    canThrow = true;
    prepareDart();
  }
}

function prepareDart(){
  if(!canThrow) return;
  dartContainer.innerHTML="";
  drawDartboard();
  currentDart = document.createElement("div");
  currentDart.className="dart";
  currentDart.style.left="194px";
  currentDart.style.bottom="0px";
  dartContainer.appendChild(currentDart);
  setupDrag();
}

function setupDrag(){
  isDragging=false;
  let countdownText = document.createElement("div");
  countdownText.style.position="absolute";
  countdownText.style.top="10px";
  countdownText.style.left="50%";
  countdownText.style.transform="translateX(-50%)";
  countdownText.style.color="red";
  countdownText.style.fontSize="22px";
  countdownText.style.fontWeight="bold";
  dartContainer.appendChild(countdownText);

  dartContainer.onmousedown=(e)=>{
    if(!canThrow) return;
    isDragging=true;
    startX=e.offsetX; startY=e.offsetY;
    power=0; powerFill.style.width="0%";
    countdown=5;
    countdownText.textContent = `Hold steady... ${countdown}`;
    countdownInterval = setInterval(()=>{
      countdown--;
      countdownText.textContent = `Hold steady... ${countdown}`;
      // Wind wobbles the aim slightly during hold
      startX += wind * 0.1;
      if(countdown<=0){
        clearInterval(countdownInterval);
        isDragging=false;
        countdownText.textContent = "";
        throwDart(angle,power);
      }
    },1000);
  };

  dartContainer.onmousemove=(e)=>{
    if(isDragging){
      let dx = e.offsetX - startX;
      let dy = startY - e.offsetY;
      angle = Math.atan2(dy, dx);
      power = Math.min(Math.sqrt(dx*dx+dy*dy), 120);
      powerFill.style.width=power+"%";
    }
  };

  dartContainer.onmouseup=()=>{
    if(isDragging){
      isDragging=false;
      clearInterval(countdownInterval);
      countdownText.textContent = "Cancelled throw!";
      setTimeout(()=>countdownText.remove(),1000);
    }
  };
}

function throwDart(a,p){
  if(!canThrow) return;
  let velX=p*Math.cos(a)/2;
  let velY=p*Math.sin(a)/2;
  let dart=currentDart;
  let posX=194;
  let posY=0;
  let interval=setInterval(()=>{
    velY-=0.5;
    posX+=velX+wind*0.05;
    posY+=velY;
    dart.style.left=posX+"px";
    dart.style.bottom=posY+"px";
    if(posY<=0){
      posY=0;
      clearInterval(interval);
      stickDart(posX,posY);
      throwsLeft--;
      if(throwsLeft>0){
        prepareDart();
      } else {
        nextTurn();
      }
    }
  },20);
}

function stickDart(x,y){
  currentDart.style.left=x+"px";
  currentDart.style.bottom=y+"px";
  scoreDart(x,y);
}

function scoreDart(x,y){
  let centerX=200,centerY=200;
  let dx=x-centerX;
  let dy=y-centerY;
  let dist=Math.sqrt(dx*dx+dy*dy);
  let points=0;
  if(dist<=20) points=50;
  else if(dist<=60) points=25;
  else if(dist<=120) points=10;
  players[currentPlayer].score+=points;
  renderScore();
  if(points>0) fireworks(x,y);
}

function fireworks(x,y){
  for(let i=0;i<30;i++){
    let f=document.createElement("div");
    f.className="firework";
    f.style.left=x+"px";
    f.style.bottom=y+"px";
    dartContainer.appendChild(f);
    let angle=Math.random()*2*Math.PI;
    let speed=Math.random()*5+2;
    let interval=setInterval(()=>{
      let left=parseFloat(f.style.left);
      let bottom=parseFloat(f.style.bottom);
      left+=Math.cos(angle)*speed;
      bottom+=Math.sin(angle)*speed;
      speed*=0.95;
      f.style.left=left+"px";
      f.style.bottom=bottom+"px";
      if(speed<0.1) { clearInterval(interval); f.remove(); }
    },30);
  }
}

function nextTurn(){
  index++;
  currentPlayer=(currentPlayer+1)%players.length;
  loadQuestion();
}

function endGame(){
  let winner = players.reduce((a,b)=>a.score>b.score?a:b);
  result.textContent = `Game Over! Winner: ${winner.name} ðŸŽ‰`;
}

function drawDartboard(){
  const rings=[120,"#ffd700",60,"#c0c0c0",20,"#ff4500"];
  for(let i=0;i<rings.length;i+=2){
    let r=document.createElement("div");
    r.className="ring";
    r.style.width=r.style.height=(rings[i]*2)+"px";
    r.style.left=(200-rings[i])+"px";
    r.style.bottom=(200-rings[i])+"px";
    r.style.background=rings[i+1];
    r.style.opacity="0.8";
    dartContainer.appendChild(r);

    // Score label
    let label = document.createElement("div");
    label.textContent = (rings[i]===20? "50 pts" : rings[i]===60? "25 pts" : "10 pts");
    label.style.position="absolute";
    label.style.left="50%";
    label.style.bottom=(200 + rings[i] - 10)+"px";
    label.style.transform="translateX(-50%)";
    label.style.color="#1a3c6d";
    label.style.fontWeight="bold";
    dartContainer.appendChild(label);
  }
}
</script>

